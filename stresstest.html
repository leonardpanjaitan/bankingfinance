<!DOCTYPE html>

<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kalkulator Simulasi Recovery Plan - Bank ABC - Created by Leonard Tiopan Panjaitan</title>

<script src="https://cdn.tailwindcss.com"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- ===== Anti Cache Global ===== -->

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<style>
body { font-family: 'Inter', sans-serif; }
.result-box { transition: all 0.3s ease-in-out; }
.bg-good { background-color: #dcfce7; color: #166534; }
.bg-warning { background-color: #fef9c3; color: #854d0e; }
.bg-crisis { background-color: #fee2e2; color: #991b1b; }
.form-input {
width: 100%;
padding: 8px 12px;
border-radius: 6px;
border: 1px solid #d1d5db;
}
</style>

</head>

<body class="bg-gray-100 text-gray-800">

<div class="container mx-auto p-4 sm:p-6 lg:p-8">

<header class="text-center mb-8">
<h1 class="text-3xl font-bold text-blue-800">Kalkulator Simulasi Stress Test & Recovery Plan</h1>
<p class="mt-2 text-gray-600">Alat interaktif untuk mengukur dampak skenario krisis dan efektivitas opsi pemulihan.</p>
</header>

<!-- ====== SELURUH FORM DAN SIMULASI TETAP SAMA ====== -->

<!-- (tidak diubah, tetap seperti script Anda) -->

<!-- ===== BACK BUTTON ===== -->

<div class="mt-8 text-center">
<a href="#" id="backBtn"
class="inline-block bg-gray-800 text-white px-6 py-3 rounded-lg shadow hover:bg-gray-700 transition w-full md:w-auto">
â¬… Back to the Main Page
</a>
</div>

</div>

<script>

// ===== Anti Cache Back Button =====
document.getElementById("backBtn").addEventListener("click", function(e){
e.preventDefault();
window.location.href = "index.html?v=" + new Date().getTime();
});

</script>

<!-- ===== SCRIPT SIMULASI ANDA (TIDAK DIUBAH) ===== -->

<script>
document.getElementById('calculateBtn').addEventListener('click', () => {
const totalModal = parseFloat(document.getElementById('totalModal').value);
const atmr = parseFloat(document.getElementById('atmr').value);
const hqla = parseFloat(document.getElementById('hqla').value);
const arusKasKeluar = parseFloat(document.getElementById('arusKasKeluar').value);
const totalAset = parseFloat(document.getElementById('totalAset').value);
const kreditBermasalah = parseFloat(document.getElementById('kreditBermasalah').value);
const totalKredit = parseFloat(document.getElementById('totalKredit').value);

const creditLossShock = parseFloat(document.getElementById('creditLossShock').value) / 100;
const depositOutflow = parseFloat(document.getElementById('depositOutflow').value) / 100;

const capitalInjection = parseFloat(document.getElementById('capitalInjection').value);
const emergencyFunding = parseFloat(document.getElementById('emergencyFunding').value);

// Baseline
const baseCAR = (totalModal / atmr) * 100;
const baseLCR = (hqla / arusKasKeluar) * 100;
const baseNPL = (kreditBermasalah / totalKredit) * 100;

// Stress
const kerugianKredit = totalKredit * creditLossShock;
const stressedModal = totalModal - kerugianKredit;
const stressedCAR = (stressedModal / atmr) * 100;
const stressedNPLAmount = kreditBermasalah + kerugianKredit;
const stressedNPL = (stressedNPLAmount / totalKredit) * 100;

const outflowTambahan = (totalAset - totalModal) * depositOutflow;
const stressedArusKasKeluar = arusKasKeluar + outflowTambahan;
const stressedLCR = (hqla / stressedArusKasKeluar) * 100;

// Recovery
const recoveredModal = stressedModal + capitalInjection;
const recoveredCAR = (recoveredModal / atmr) * 100;

const recoveredHQLA = hqla + emergencyFunding;
const recoveredLCR = (recoveredHQLA / stressedArusKasKeluar) * 100;

// Display
displayResults('baselineResults', baseCAR, baseLCR, baseNPL);
displayResults('stressedResults', stressedCAR, stressedLCR, stressedNPL);
displayResults('recoveryResults', recoveredCAR, recoveredLCR, stressedNPL);
});

function displayResults(elementId, car, lcr, npl) {
const container = document.getElementById(elementId);

const carStatus = getStatus(car, 14, 10);
const lcrStatus = getStatus(lcr, 100, 85);
const nplStatus = getStatus(npl, 5, 5, true);

container.innerHTML = `
<div class="result-box ${carStatus.class} p-3 rounded-md">
<p class="font-semibold text-sm">CAR</p>
<p class="font-bold text-xl">${car.toFixed(2)}%</p>
</div>
<div class="result-box ${lcrStatus.class} p-3 rounded-md">
<p class="font-semibold text-sm">LCR</p>
<p class="font-bold text-xl">${lcr.toFixed(2)}%</p>
</div>
<div class="result-box ${nplStatus.class} p-3 rounded-md">
<p class="font-semibold text-sm">NPL</p>
<p class="font-bold text-xl">${npl.toFixed(2)}%</p>
</div>`;
}

function getStatus(value, goodThreshold, crisisThreshold, inverted = false) {
if (inverted) {
if (value >= crisisThreshold) return { class: 'bg-crisis' };
return { class: 'bg-good' };
}
if (value >= goodThreshold) return { class: 'bg-good' };
else if (value >= crisisThreshold) return { class: 'bg-warning' };
else return { class: 'bg-crisis' };
}

// auto run
document.addEventListener('DOMContentLoaded', () => {
document.getElementById('calculateBtn').click();
});
</script>

</body>
</html>
